!function(){"use-strict";angular.module("app",["routes","app.layout","services","xml"])}(),function(){"use strict";angular.module("core",[])}(),function(){"use strict";angular.module("departures",["services"])}(),function(){"use strict";angular.module("exception",["logger"])}(),function(){"use strict";angular.module("app.layout",["menus","departures","stations","trips","utils","routes"])}(),function(){angular.module("logger",[])}(),function(){"use strict";angular.module("menus",["ngAnimate"])}(),function(){"use strict";angular.module("routes",["ui.router","logger","services"])}(),function(){"use strict";angular.module("services",["core","xml","exception"])}(),function(){"use strict";angular.module("stations",["services"])}(),function(){"use strict";angular.module("trips",["services","logger"])}(),function(){"use strict";angular.module("utils",["core"])}(),function(){"use strict";function t(t){t.interceptors.push("xmlHttpInterceptor")}var e=angular.module("core"),n={appErrorPrefix:"[Public Transit Error] ",appTitle:"Public Transit App",key:"QL4I-PMEK-9PRT-DWE9",urls:{root:"http://api.bart.gov/api/",advisories:"bsa.aspx?",estimates:"etd.aspx?",routes:"route.aspx?",schedules:"sched.aspx?",stations:"stn.aspx?"}};e.value("config",n),e.config(t),t.$inject=["$httpProvider"]}(),function(){"use strict";function t(t,e){var n=this;n.stations=t,n.currentStation={},n.currentDepartures={},n.getCurrentDepartures=function(){e.getCurrentDepartures(JSON.parse(n.currentStation)).then(function(t){n.currentStation=JSON.parse(n.currentStation),n.currentDepartures=t.root.station.etd})}}angular.module("departures").controller("departuresController",t),t.$inject=["stations","departuresService"]}(),function(){"use strict";function t(){var t={templateUrl:"/src/client/app/departures/departures.template.html",link:function(t,e,n){}};return t}angular.module("departures").directive("btDepartures",t)}(),function(){"use strict";function t(){var t={template:"<bt-departures></bt-departures>",link:function(t){t.title="Real Time Departures"}};return t}angular.module("app").directive("wwaDepartures",t)}(),function(){"use strict";function t(){var t={template:"<bt-stations></bt-stations>",link:function(t){t.title="Stations List"}};return t}angular.module("app").directive("wwaStations",t)}(),function(){"use strict";function t(){var t={template:"<bt-trips></bt-trips>",link:function(t){t.title="Plan a trip"}};return t}angular.module("app").directive("wwaTrips",t)}(),function(){"use strict";function t(t,e){function n(n){return function(i){var r=n+": "+i;return e.error(r,i),t.reject(r)}}var i={catcher:n};return i}angular.module("exception").factory("exceptionCatcher",t),t.$inject=["$q","logger"]}(),function(){"use strict";function t(){this.config={appErrorPrefix:"Public Transit Error: "},this.configure=function(t){this.config.appErrorPrefix=t},this.$get=function(){return{config:this.config}}}function e(t){t.decorator("$exceptionHandler",n)}function n(t,e,n){return function(i,r){var o=e.config.appErrorPrefix||"",s={exception:i,cause:r};i.message=o+i.message,t(i,r),n.error(i.message,s)}}angular.module("exception").provider("exceptionHandler",t).config(e),e.$inject=["$provide"],n.$inject=["$delegate","exceptionHandler","logger"]}(),function(){"use strict";function t(t,e,n,i,r){t.isMenuVisible=!0,t.isMenuButtonVisible=!0,t.isMenuVertical=!0;var o=function(){var e=Math.max($(n).innerWidth(),n.innerWidth);t.isMenuVisible=e>768,t.isMenuButtonVisible=!t.isMenuVisible},s=function(){e.$broadcast("bt-menu-show",{show:t.isMenuVisible,isVertical:t.isMenuVertical,allowHorizontalToggle:!t.isMenuButtonVisible})};t.$on("bt-menu-item-selected-event",function(e,n){t.state=n.state,r.go(n.state),o(),s()}),t.$on("bt-menu-orientation-changed-event",function(e,n){t.isMenuVertical=n.isMenuVertical}),$(n).on("resize.layout",function(){t.$apply(function(){o(),s()})}),t.$on("$destroy",function(){$(n).off("resize.layout")}),t.menuButtonClicked=function(){t.isMenuVisible=!t.isMenuVisible,s(),t.$apply()},i(function(){o()},0)}angular.module("app.layout").controller("layoutController",t),t.$inject=["$scope","$rootScope","$window","$timeout","$state"]}(),function(){"use strict";function t(){var t={transclude:!0,scope:{title:"@",subtitle:"@",iconFile:"="},controller:"layoutController",templateUrl:"/src/client/app/layout/layout.template.html"};return t}angular.module("app.layout").directive("appLayout",t)}(),function(){"use strict";function t(t){function e(e,n){t.error("Error: "+e,n)}function n(e,n){t.warn("Warning: "+e,n)}function i(e,n){t.info("Info: "+e,n)}function r(e,n){t.success("Success: "+e,n)}var o={error:e,warning:n,info:i,success:r,log:t.log};return o}angular.module("logger").factory("logger",t),t.$inject=["$log"]}(),function(){"use strict";function t(){return{require:"^btMenu",transclude:!0,scope:{label:"@",icon:"@"},templateUrl:"/src/client/app/menus/menu.group.template.html",link:function(t,e,n,i){t.isOpen=!1,t.closeMenu=function(){t.isOpen=!1},t.clicked=function(){t.isOpen=!t.isOpen,0==e.parents(".bt-subtiem-section").length&&t.setSubmenuPosition(),i.setOpenMenuScope(t)},t.isVertical=function(){return i.isVertical()},t.setSubmenuPosition=function(){var t=e.offset();$(".bt-subitem-section").css({left:t.left+20,top:36})}}}}angular.module("menus").directive("btMenuGroup",t)}(),function(){"use strict";function t(){var t={require:"^btMenu",scope:{label:"@",icon:"@",state:"@"},templateUrl:"/src/client/app/menus/menu.item.template.html",link:function(t,e,n,i){t.isActive=function(){return e===i.getActiveElement()},t.isVertical=function(){return i.isVertical()||e.parents(".bt-subitem-section").length>0},e.on("click",function(n){n.stopPropagation(),n.preventDefault(),t.$apply(function(){i.setActiveElement(e),i.setState(t.state)})})}};return t}angular.module("menus").directive("btMenuItem",t)}(),function(){"use strict";function t(t,e){t.showMenu=!0,t.isVertical=!0,t.showMenu=!0,t.allowHorizontalToggle=!0,this.setActiveElement=function(e){t.activeElement=e},this.setState=function(t){e.$broadcast("bt-menu-item-selected-event",{state:t})},this.isVertical=function(){return t.isVertical},this.getActiveElement=function(){return t.activeElement},t.$on("bt-menu-show",function(e,n){t.showMenu=n.show,t.isVertical=n.isVertical,t.allowHorizontalToggle=n.allowHorizontalToggle}),this.setOpenMenuScope=function(e){t.openMenuScope=e},t.toggleMenuOrientation=function(){t.openMenuScope&&t.openMenuScope.closeMenu(),t.isVertical=!t.isVertical,e.$broadcast("bt-menu-orientation-changed-event",{isMenuVertical:t.isVertical})},angular.element(document).bind("click",function(e){if(t.openMenuScope&&!t.isVertical){if($(e.target).parent().hasClass("bt-selectable-item"))return;t.$apply(function(){t.openMenuScope.closeMenu()}),e.preventDefault(),e.stopPropagation()}})}angular.module("menus").controller("menusController",t),t.$inject=["$scope","$rootScope"]}(),function(){"use strict";function t(t){var e={scope:{},transclude:!0,templateUrl:"/src/client/app/menus/menu.template.html",controller:"menusController",link:function(e,n,i){var r=n.find(".bt-selectable-item:first");t(function(){r.trigger("click")})}};return e}angular.module("menus").directive("btMenu",t),t.$inject=["$timeout"]}(),function(){"use strict";function t(t){t.configureStates(e())}function e(){return[{state:"departures",config:{url:"/",template:"<wwa-departures></wwa-departures>",controller:"departuresController",controllerAs:"vm"}}]}angular.module("routes").run(t),t.$inject=["routerHelper"]}(),function(){"use strict";function t(t,e,n){function i(t){return t.getStations()}function r(t,i,r,s){function a(t,i){t.forEach(function(t){t.config.resolve=angular.extend(t.config.resolve||{},o.resolveAlways),e.state(t.state,t.config)}),i&&!m&&(m=!0,n.otherwise(i))}function l(){i.$on("$stateChangeError",function(e,n,i,r,o,s){if(!d){g.errors++,d=!0;var a=n&&(n.title||n.name||n.loadedTemplateUrl)||"unknown target";"Error routing to "+a+". "+(s.data||"")+". <br/>"+(s.statusText||"")+": "+(s.status||"");t.path("/")}})}function c(){i.$on("$stateChangeSuccess",function(t,e,n,r,s){g.changes++,d=!1;var a=o.docTitle+" "+(e.title||"");i.title=a})}function u(){l(),c()}function p(){return r.get()}var d=!1,m=!1,f={configureStates:a,getStates:p},g={errors:0,changes:0};return u(),f}t.html5Mode({enabled:!0,requireBase:!1}),this.$get=r;var o={docTitle:"Bart App: ",resolveAlways:{stations:i}};r.$inject=["$location","$rootScope","$state","logger"]}angular.module("routes").provider("routerHelper",t),t.$inject=["$locationProvider","$stateProvider","$urlRouterProvider"]}(),function(){"use strict";function t(t){t.configureStates(e())}function e(){return[{state:"stations",config:{url:"/stations",template:"<wwa-stations></wwa-stations>",controller:"stationsController",controllerAs:"vm"}}]}angular.module("routes").run(t),t.$inject=["routerHelper"]}(),function(){"use strict";function t(t){t.configureStates(e())}function e(){return[{state:"trips",config:{url:"/trips",template:"<wwa-trips></wwa-trips>",controller:"tripsController",controllerAs:"vm"}},{state:"trip_detail",config:{url:"/trip_detail",template:"/src/client/app/trips/trip.detail.html",controller:"tripDetail",controllerAs:"vm"}}]}angular.module("routes").run(t),t.$inject=["routerHelper"]}(),function(){"use strict";function t(t,e,n,i){function r(r){function o(t){return t.data.root.message&&s(t),t.data}function s(t){return i.catcher("Failed to get departure data")(t.data.root.message.error)}var a={cache:!0},l={cmd:"etd",orig:r.abbr},c=e.urls.estimates,u=n.buildUrl(l,c);return t.get(u,a).then(o).catch(s)}var o={getCurrentDepartures:r};return o}angular.module("services").factory("departuresService",t),t.$inject=["$http","config","utils","exceptionCatcher"]}(),function(){"use strict";function t(t,e,n,i){function r(){function r(t){return t.data.root.message&&o(t),t.data.root.stations.station}function o(t){return i.catcher("Failed to get stations Data")(t.data.root.message.error)}var s={cache:!0},a={cmd:"stns",key:t.key},l=t.urls.stations,c=n.buildUrl(a,l);return e.get(c,s).then(r).catch(o)}var o={getStations:r};return o}angular.module("services").factory("stationsService",t),t.$inject=["config","$http","utils","exceptionCatcher"]}(),function(){"use strict";function t(t,e,n,i){function r(r){function o(t){return t.data.root.message.error?void s(t):t.data}function s(t){return i.catcher("Failed to get Trip data")(t.data.root.message.error)}var a={cache:!0},l={};l.orig=r.orig,l.cmd=r.cmd,l.dest=r.dest;var c=e.urls.schedules,u=n.buildUrl(l,c);return t.get(u,a).then(o).catch(s)}var o={getSchedule:r};return o}angular.module("services").factory("tripsService",t),t.$inject=["$http","config","utils","exceptionCatcher"]}(),function(){"use strict";function t(t){var e=this;console.log("stations ",t),e.stations=t}angular.module("stations").controller("stationsController",t),t.$inject=["stations"]}(),function(){"use strict";function t(){var t={templateUrl:"/src/client/app/stations/stations.template.html",link:function(t,e,n){}};return t}angular.module("stations").directive("btStations",t)}(),function(){"use strict";function t(){function t(){return tripsService.getSchedule(e.trip).then(function(t){e.schedules=t,console.log(e.schedules)})}var e=this;e.schedules={},t()}angular.module("trips").factory("tripDetail",t),t.$inject=[]}(),function(){"use strict";function t(t,e,n){var i=this;i.stations=t,console.log("in trips : ",t),i.trip={},i.getSchedule=function(){$state.go("trip_detail",{trip:i.trip})}}angular.module("trips").controller("tripsController",t),t.$inject=["stations","tripsService","logger"]}(),function(){"use strict";function t(){var t={templateUrl:"/src/client/app/trips/trips.forms.html",link:function(t,e,n){}};return t}angular.module("trips").directive("btTrips",t)}(),function(){"use strict";function t(t){function e(e,i){e.key=t.key;var r=n(e),o=t.urls.root.concat(i,r);return o}function n(t){return Object.keys(t).map(function(e){return[e,t[e]].map(encodeURIComponent).join("=")}).join("&")}var i={buildUrl:e};return i}angular.module("utils").factory("utils",t),t.$inject=["config"]}(),angular.module("core").run(["$templateCache",function(t){t.put("app/departures/departures.template.html",'<div class=bt-dashboard-header>{{ title }}</div><div class=container><div class=row><form class=form-inline name=stationNames><div class=form-group><label class="control-label bt-logo-title" for=stationNameList><strong>Station Names</strong></label><select class="form-control selectpicker" name=stationNameList id=stationNameList ng-model=vm.currentStation><option ng-repeat="station in vm.stations track by $index" value="{{ station }}">{{ station.name }}</option></select></div><button type=submit class="btn btn-primary" ng-click=vm.getCurrentDepartures()>Get Stations</button><br></form></div><br><div class=row><div class="panel panel-default"><div class=panel-heading>Departures from {{ vm.currentStation.name }}</div><table class=table><thead><tr><th><strong>Destination<strong></strong></strong></th><th><strong>Estimates<strong></strong></strong></th></tr></thead><tbody><tr ng-repeat="departure in vm.currentDepartures track by $index"><td>{{ departure.destination }}</td><td><span ng-repeat="est in departure.estimate track by $index">{{ est.minutes }} min | <span></span></span></td></tr></tbody></table></div></div></div>'),t.put("app/layout/layout.template.html",'<div class=bt-title-bar><div class=row><div class="bt-logo-area col-sm-6"><img class=bt-icon ng-src=/src/client/images/bart.png><div class=bt-title-area><p class=bt-logo-title>{{ title }}</p><p class=bt-logo-subtitle>{{ subtitle }}</p></div><div ng-if=isMenuButtonVisible ng-click=menuButtonClicked() class="bt-collapsed-menu pull-right"><button type=button class="btn bt-nav-button"><i class="fa fa-bars"></i></button></div></div></div></div><div ng-transclude></div><div ui-view class=bt-view ng-class="{\'bt-view-full-width\' : !isMenuVertical || !isMenuVisible }"></div>'),t.put("app/menus/menu.group.template.html",'<li class=bt-selectable-item ng-click=clicked() ng-class="{\'bt-item-horizontal\' : !isVertical()}"><div class=bt-noselect><i class="fa {{ icon }} bt-menu-icon"></i> {{ label }}</div><i ng-if=isVertical() class="fa fa-chevron-left bt-group-indicator-left" ng-class="{ \'fa-rotate-270\' : isOpen }"></i></li><div ng-show=isOpen class="bt-subitem-section bt-fade-in-animation" ng-class="{ \'bt-popup-menu\' : !isVertical()}"><ul ng-transclude></ul></div>'),t.put("app/menus/menu.item.template.html",'<li class=bt-selectable-item ng-class="{\'bt-item-horizontal\' : !isVertical()}"><div class=bt-noselect><i class="fa {{ icon }} bt-menu-icon"></i> {{ label }}</div><i ng-if="isActive() && isVertical()" class="fa fa-2x fa-caret-left bt-menu-active-indicator"></i></li>'),t.put("app/menus/menu.template.html","<div class=bt-menu-area ng-show=showMenu ng-class=\"{'bt-menu-area-vertical': isVertical, 'bt-menu-area-horizontal': !isVertical }\"><ul class=bt-menu ng-transclude></ul><a class=\"btn bt-menu-layout-button\" ng-show=allowHorizontalToggle ng-class=\"{ 'bt-layout-button-horizontal': !isVertical }\" ng-click=toggleMenuOrientation()><i class=fa ng-class=\"{'fa-chevron-up' : isVertical, 'fa-chevron-left' : !isVertical }\" fa-chevron-up\"></i></a></div>"),t.put("app/stations/stations.template.html",'<div class=bt-dashboard-header>{{ title }}</div><div class=list-group><a href=# class="list-group-item active">We have {{ vm.stations.length }} Stations</a> <a href=# class="list-group-item action" ng-repeat="station in vm.stations track by $index">{{ station.name }}</a></div>'),t.put("app/trips/trip.detail.html",""),t.put("app/trips/trips.forms.html",'<div class=bt-dashboard-header>{{ title }}</div><div class=container><form><div class="form-group row"><div class=col-sm-2><label for=stationNameList class=control-label>Station Source</label></div><div class=col-sm-4><select class=form-control name=stationNameList id=stationNameList ng-model=vm.trip.orig><option ng-repeat="station in vm.stations track by $index" value="{{ station.abbr }}">{{ station.name }}</option></select></div></div><div class="form-group row"><div class=col-sm-2><label for=stationDestList class=control-label>Station Destination</label></div><div class=col-sm-4><select class=form-control name=stationDestList id=stationDestList ng-model=vm.trip.dest><option ng-repeat="station in vm.stations track by $index" value="{{ station.abbr }}">{{ station.name }}</option></select></div></div><div class=row><div class="form-group col-sm-6"><label class="custom-control custom-radio"><input id=dep name=depart type=radio value=depart class=custom-control-input ng-model=vm.trip.cmd> <span class=custom-control-indicator></span> <span class=custom-control-description>Departures</span></label></div><div class="form-group col-sm-6"><label class="custom-control custom-radio"><input id=arri name=arri type=radio value=arrive class=custom-control-input ng-model=vm.trip.cmd> <span class=custom-control-indicator></span> <span class=custom-control-description>Arrivals</span></label></div></div><div class="form-group row"><div class=col-sm-2><label for=tripDate class=control-label>Date</label></div><div class=col-sm-4><input class=form-control type=date value=2011-08-19 id=tripDate ng-model=vm.trip.date></div></div><div class="form-group row"><div class=col-sm-2><label for=tripTime class=control-label>Time</label></div><div class=col-sm-4><input class=form-control type=time value=13:45:00 id=tripTime ng-model=vm.trip.time></div></div><button type=submit ng-click=vm.getSchedule(trip) class="btn btn-primary">Get Schedule</button></form></div>')}]);